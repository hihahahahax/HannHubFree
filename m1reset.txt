local UIS = game:GetService("UserInputService")
local VIM = game:GetService("VirtualInputManager")
local TweenService = game:GetService("TweenService")
local player = game.Players.LocalPlayer
local camera = workspace.CurrentCamera

local gui = Instance.new("ScreenGui")
gui.Name = "HannHub"
gui.ResetOnSpawn = false
gui.IgnoreGuiInset = true
gui.Parent = game.CoreGui

-- Toggle Button
local toggleBtn = Instance.new("TextButton")
toggleBtn.Size = UDim2.new(0, 35, 0, 35)
toggleBtn.Position = UDim2.new(0, 5, 0.5, -17)
toggleBtn.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
toggleBtn.Text = "â‰¡"
toggleBtn.TextColor3 = Color3.fromRGB(255,255,255)
toggleBtn.Font = Enum.Font.GothamBold
toggleBtn.TextSize = 20
toggleBtn.Parent = gui

-- Main Frame
local mainFrame = Instance.new("Frame")
mainFrame.Size = UDim2.new(0, 240, 0, 160)
mainFrame.Position = UDim2.new(0.5, -120, 0.5, -80)
mainFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
mainFrame.Visible = true
mainFrame.Active = true
mainFrame.Draggable = true
mainFrame.Parent = gui

-- Corner & Stroke
local corner = Instance.new("UICorner", mainFrame)
corner.CornerRadius = UDim.new(0, 10)
local stroke = Instance.new("UIStroke", mainFrame)
stroke.Color = Color3.fromRGB(255, 150, 0)
stroke.Thickness = 1.5

-- Title
local title = Instance.new("TextLabel")
title.Size = UDim2.new(1, 0, 0, 30)
title.BackgroundTransparency = 1
title.Text = "M1 Reset | Hann Hub"
title.Font = Enum.Font.GothamBold
title.TextSize = 16
title.TextColor3 = Color3.fromRGB(255, 255, 255)
title.Parent = mainFrame

-- Button Maker
local function createButton(text, posY)
	local btn = Instance.new("TextButton")
	btn.Size = UDim2.new(0.9, 0, 0, 35)
	btn.Position = UDim2.new(0.05, 0, 0, posY)
	btn.BackgroundColor3 = Color3.fromRGB(100, 100, 100)
	btn.Text = text
	btn.TextColor3 = Color3.fromRGB(255, 255, 255)
	btn.Font = Enum.Font.GothamBold
	btn.TextSize = 14

	local corner = Instance.new("UICorner", btn)
	corner.CornerRadius = UDim.new(0, 6)

	btn.MouseEnter:Connect(function()
		TweenService:Create(btn, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(255, 150, 0)}):Play()
	end)
	btn.MouseLeave:Connect(function()
		TweenService:Create(btn, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(100, 100, 100)}):Play()
	end)

	btn.Parent = mainFrame
	return btn
end

-- Get Character
local function getCharacter()
	local char = player.Character
	local hum = char and char:FindFirstChildOfClass("Humanoid")
	return char, hum
end

-- Stop all animations
local function stopAllAnimations()
	local _, hum = getCharacter()
	if hum then
		local animator = hum:FindFirstChildOfClass("Animator")
		if animator then
			for _, track in ipairs(animator:GetPlayingAnimationTracks()) do
				track:Stop()
			end
		end
	end
end

-- Play animation
local animationCache = {}
local function playAnimation(id)
	local _, hum = getCharacter()
	if not hum then return end

	local animator = hum:FindFirstChildOfClass("Animator")
	if not animator then
		animator = Instance.new("Animator", hum)
	end

	local anim = animationCache[id]
	if not anim then
		anim = Instance.new("Animation")
		anim.AnimationId = "rbxassetid://" .. id
		animationCache[id] = anim
	end

	local track = animator:LoadAnimation(anim)
	track.Priority = Enum.AnimationPriority.Action
	track:Play()
	track:AdjustSpeed(1.1)
	return track
end

-- Side Dash
local function sideDash(direction, distance, duration)
	local char, _ = getCharacter()
	local root = char and char:FindFirstChild("HumanoidRootPart")
	if root then
		local tween = TweenService:Create(root, TweenInfo.new(duration, Enum.EasingStyle.Quad), {
			CFrame = root.CFrame * CFrame.new(direction * distance, 0, 0)
		})
		tween:Play()
		tween.Completed:Wait()
	end
end

-- Impulse Dash
local function impulseDash(direction, distance, height, power, duration)
	local char, _ = getCharacter()
	local root = char and char:FindFirstChild("HumanoidRootPart")
	if root then
		local force = Instance.new("BodyVelocity")
		force.Velocity = (root.CFrame.RightVector * direction * distance + Vector3.new(0, height, 0)).Unit * power
		force.MaxForce = Vector3.new(1e5, 1e5, 1e5)
		force.Parent = root
		task.delay(duration, function() force:Destroy() end)
	end
end

-- M1 Reset
local btn1 = createButton("M1 Reset", 40)
btn1.MouseButton1Click:Connect(function()
	task.spawn(function()
		stopAllAnimations()
		playAnimation(10480793962)
		sideDash(1, 25.5, 0.24)
		task.wait(0.004)
		VIM:SendKeyEvent(true, Enum.KeyCode.Q, false, game)
		VIM:SendKeyEvent(false, Enum.KeyCode.Q, false, game)
	end)
end)

-- Emote Dash
local btn2 = createButton("Emote Dash", 85)
btn2.MouseButton1Click:Connect(function()
	task.spawn(function()
		stopAllAnimations()
		playAnimation(10480793962)
		impulseDash(1, 37, 7, 90, 0.29)
	end)
end)

-- Toggle visibility
toggleBtn.MouseButton1Click:Connect(function()
	mainFrame.Visible = not mainFrame.Visible
end)